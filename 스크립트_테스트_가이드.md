# 엑셀 → Google Sheets 업로드 스크립트 테스트

## ✅ 설정 확인

### 1. .env.local 파일 확인
다음 항목이 있는지 확인하세요:

```env
GOOGLE_SHEETS_ID=1xLGmNw8JfgGk2Y01WAsSQ4cBOofynaXVmne165i_ly8
GOOGLE_API_KEY=your-api-key
GOOGLE_OAUTH_CLIENT_ID=your-oauth-client-id
GOOGLE_OAUTH_CLIENT_SECRET=your-oauth-client-secret
```

### 2. Google Sheets 확인
- "담보별_보험료" 시트가 생성되어 있는지 확인
- 없으면 수동으로 생성하거나 스크립트가 자동 생성 시도

---

## 🚀 스크립트 실행

```bash
npm run upload-premium-data
```

---

## 📋 예상 결과

### 성공 시:
```
✅ .env.local 파일 로드 완료
🚀 담보별 보험료 데이터 자동 업로드 시작
📁 발견된 파일: 6개
📖 파일 읽는 중: ...
   ✅ 변환된 데이터: 350개
...
📊 총 데이터: 1960개
📤 Google Sheets에 업로드 중...
   🔑 서비스 계정 인증 사용 중... (또는 OAuth)
✅ 업로드 완료! 총 1960개의 데이터가 업로드되었습니다.
✅ CSV 파일 생성 완료: data/담보별_보험료.csv
```

### 실패 시 (API Key만 있는 경우):
```
⚠️ API Key 사용 중 (읽기 전용, 쓰기 불가)
💡 Google Sheets 쓰기를 위해서는 서비스 계정이 필요합니다.
📝 CSV 파일이 자동으로 생성되니 수동으로 업로드해주세요.
✅ CSV 파일 생성 완료: data/담보별_보험료.csv
```

---

## 💡 OAuth vs 서비스 계정

### 현재: OAuth 클라이언트 ID
- ⚠️ **사용자 인증 필요**: 브라우저에서 로그인 필요
- ⚠️ **스크립트에 복잡**: 자동화 어려움

### 권장: 서비스 계정
- ✅ **자동 인증**: 토큰 자동 갱신
- ✅ **스크립트 완벽**: 자동화에 최적

**서비스 계정 설정**: `GOOGLE_서비스계정_설정_가이드.md` 참고

---

## 🔧 문제 해결

### OAuth 인증 오류
→ 서비스 계정으로 전환 권장

### CSV 파일만 생성됨
→ 정상입니다! CSV 파일을 Google Sheets에 수동 업로드하세요.

### 시트를 찾을 수 없음
→ Google Sheets에서 "담보별_보험료" 시트를 수동으로 생성하세요.

