# Google Sheets 담보별 보험료 데이터 변환 가이드

## 📋 개요

6개의 엑셀 파일(30세 남/여, 40세 남/여, 50세 남/여)을 Google Sheets에 복사 붙여넣기하고, 자동으로 세로형 데이터로 변환하는 방법입니다.

---

## 🚀 방법 1: Google Apps Script 사용 (자동 변환)

### 1단계: Google Sheets에서 Apps Script 열기

1. Google Sheets 열기: [새 Sheets 링크](https://docs.google.com/spreadsheets/d/1xLGmNw8JfgGk2Y01WAsSQ4cBOofynaXVmne165i_ly8/edit)
2. **"확장 프로그램"** 메뉴 클릭
3. **"Apps Script"** 클릭

### 2단계: 스크립트 붙여넣기

1. 새 프로젝트가 열리면 기존 코드 삭제
2. `scripts/convert-premium-data.js` 파일의 내용 복사
3. 붙여넣기
4. 저장 (Ctrl+S 또는 저장 버튼)

### 3단계: 각 엑셀 파일 변환

각 엑셀 파일마다 다음을 반복:

#### 30세 남
1. 엑셀 파일 열기
2. 데이터 복사 (담보명, 가입금액, 보험사별 보험료)
3. Google Sheets에 새 시트 생성 (이름: `30세_남_원본`)
4. 붙여넣기
5. Apps Script로 돌아가기
6. 함수 선택: `convertPremiumData`
7. 실행 버튼 클릭
8. 연령 입력: `30`
9. 성별 입력: `남`
10. 확인

**결과**: `담보별_보험료_30세_남` 시트가 자동 생성됩니다.

#### 나머지 파일들도 동일하게 반복:
- 30세 여 → `담보별_보험료_30세_여`
- 40세 남 → `담보별_보험료_40세_남`
- 40세 여 → `담보별_보험료_40세_여`
- 50세 남 → `담보별_보험료_50세_남`
- 50세 여 → `담보별_보험료_50세_여`

### 4단계: 모든 데이터 통합

1. Apps Script로 돌아가기
2. 함수 선택: `mergePremiumData`
3. 실행 버튼 클릭

**결과**: `담보별_보험료` 시트가 생성되고 모든 데이터가 통합됩니다.

---

## 🔧 방법 2: 수동 변환 (Apps Script 없이)

### Google Sheets에 직접 입력

1. Google Sheets에 새 시트 생성: `담보별_보험료`
2. 헤더 입력:
   ```
   연령 | 성별 | 담보명 | 가입금액 | 보험사 | 보험료
   ```

3. 각 엑셀 파일에서:
   - 담보명 복사 → C열에 입력
   - 가입금액 복사 → D열에 입력
   - 각 보험사별 보험료를 별도 행으로 입력
   - A열에 연령 (30, 40, 50)
   - B열에 성별 (남, 여)
   - E열에 보험사 이름
   - F열에 보험료

### 예시:
```
연령 | 성별 | 담보명          | 가입금액 | 보험사      | 보험료
30   | 남   | 뇌혈관진단비     | 30000000 | 하나손해    | 3605
30   | 남   | 뇌혈관진단비     | 30000000 | 메리츠화재  | 3800
30   | 남   | 질병입원비       | 10000    | 하나손해    | 30000
```

---

## ✅ 최종 확인

### `담보별_보험료` 시트 구조:

| A (연령) | B (성별) | C (담보명) | D (가입금액) | E (보험사) | F (보험료) |
|----------|----------|------------|--------------|------------|-----------|
| 30 | 남 | 뇌혈관진단비 | 30000000 | 하나손해 | 3605 |
| 30 | 남 | 뇌혈관진단비 | 30000000 | 메리츠화재 | 3800 |
| 30 | 여 | 뇌혈관진단비 | 30000000 | 하나손해 | 3200 |
| ... | ... | ... | ... | ... | ... |

### 데이터 확인:
- 6개 파일 (30세 남/여, 40세 남/여, 50세 남/여) 모두 포함되었는지 확인
- 각 담보별로 모든 보험사의 데이터가 있는지 확인

---

## 📝 참고사항

- 시트 이름은 정확히 `담보별_보험료`로 해야 코드가 인식합니다
- 헤더는 첫 번째 행에 있어야 합니다
- 데이터는 A2부터 시작해야 합니다
- 합계 행은 제외해야 합니다

---

## 🎯 완료 후

데이터 변환이 완료되면:
1. Google Sheets 공개 설정 확인
2. `.env.local`의 `GOOGLE_SHEETS_ID` 확인
3. 테스트: `http://localhost:3000/api/test-apis`

담보별 보험료 데이터가 자동으로 블로그에 포함됩니다!

