# Q&A 프롬프트 모델 적합성 분석

## 전체 프롬프트 구조

### 1. 질문 생성 (generateQuestionPrompt) - 약 420줄

**복잡도: 중간**

**주요 요구사항:**
- 나이/성별에 맞는 말투 생성 (동적 계산)
- 고객 스타일 유지 (cold, brief, curious, friendly) - 4가지 스타일
- 전문 용어 사용 (하지만 완전히 이해하지 못한 느낌)
- 다양한 패턴 생성:
  * 15가지 제목 패턴
  * 12가지 시작 패턴
  * 10가지 구조
  * 10가지 유형
- 마침표 사용 금지
- 자연스러운 오타 허용 (적절한 수준)

**추론 난이도: 중간-낮음**
- 패턴 기반 생성
- 스타일 유지
- 복잡한 추론 불필요

**모델 추천: ⭐ 2.0 Flash 적합**
- 이유: 패턴 기반 생성이 주 목적이며, 복잡한 추론이 필요하지 않음
- 비용 절감: 약 12.5배 저렴 (Input), 약 25배 저렴 (Output)

---

### 2. 답변 생성 (generateAnswerPrompt) - 약 428줄

**복잡도: 매우 높음**

**주요 요구사항:**
- 15년 경력 전문가 역할
- 구체적 금액/조건 명시 (모호한 표현 금지)
- 경쟁사 비교 분석 (2-3개 상품 구체적 비교)
- 리스크 및 제한사항 분석
- Google Grounding 활용 (최신 정보 반영)
- 구매 유도 (심리적 설득)
- 다양한 패턴:
  * 15가지 시작 패턴
  * 12가지 구조
  * 8가지 설명 순서
- 복잡한 포맷팅:
  * 4-5개 문단 구성
  * 이모티콘 배치 규칙 (문단 시작점)
  * 줄바꿈 규칙 (엄격)
  * 마침표 사용 금지
- 문단 순서 다양화 (매번 다르게)

**추론 난이도: 매우 높음**
- 복잡한 분석 및 비교
- 심리적 설득 전략
- 맥락 이해 및 일관성 유지
- 복잡한 포맷팅 규칙 준수

**모델 추천: ⭐⭐⭐ 2.5 Pro 필수**
- 이유:
  1. **전문적 분석**: 경쟁사 비교, 리스크 분석 등 복잡한 추론 필요
  2. **Google Grounding 활용**: 최신 정보를 활용한 분석 필요
  3. **구매 유도**: 심리적 설득 전략 필요
  4. **복잡한 포맷팅**: 문단 구성, 이모티콘 배치 등 복잡한 규칙 준수
  5. **일관성 유지**: 전체 답변의 논리적 흐름 유지

---

### 3. 대화형 스레드 (generateConversationThreadPrompt) - 약 405줄

**복잡도: 높음**

**주요 요구사항:**
- 이전 대화 맥락 이해 및 활용
- 고객/설계사 역할 전환 (홀수/짝수 단계)
- 단계별 심화 질문 (초반/중반/후반)
- 일관성 유지 (첫 답변과의 일관성)
- 마지막 댓글 마무리 구조 (3단계)
- 고객 스타일 유지
- 다양한 패턴:
  * 고객: 15가지 시작 패턴, 8가지 구조
  * 설계사: 15가지 시작 패턴, 8가지 구조, 8가지 순서

**추론 난이도: 높음**
- 맥락 이해 및 활용
- 역할 전환
- 단계별 전략
- 일관성 유지

**모델 추천: ⭐⭐ 2.5 Pro 권장 (2.0 Flash도 가능)**
- 이유:
  1. **맥락 이해**: 이전 대화를 이해하고 자연스럽게 이어가는 것이 중요
  2. **일관성 유지**: 첫 답변과의 일관성 유지 필요
  3. **단계별 전략**: 초반/중반/후반에 따른 질문/답변 전략 필요
  4. 다만, 질문 생성 부분은 2.0 Flash로도 가능할 수 있음

---

## 전체 분석 결과

### 현재 사용 중인 모델
- `['gemini-2.5-pro', 'gemini-1.5-pro', 'gemini-1.5-flash']` (폴백 순서)

### 추천 전략

#### 옵션 1: 하이브리드 방식 (최적) ⭐⭐⭐
```
질문 생성: 2.0 Flash
답변 생성: 2.5 Pro
대화형 스레드:
  - 고객 댓글: 2.0 Flash
  - 설계사 댓글: 2.5 Pro
```

**장점:**
- 비용 절감: 약 50-60% 절감 가능
- 품질 유지: 중요한 답변은 2.5 Pro 사용
- 효율성: 각 작업에 적합한 모델 사용

**비용 비교 (예시):**
- 질문 1개 (500 토큰): 2.5 Pro $0.005 vs 2.0 Flash $0.0002 (25배 차이)
- 답변 1개 (700 토큰): 2.5 Pro $0.007 (유지)
- 대화형 스레드 (평균 200 토큰/댓글):
  * 고객 댓글: 2.0 Flash $0.00008
  * 설계사 댓글: 2.5 Pro $0.002

#### 옵션 2: 전체 2.5 Pro 유지 (현재)
```
모든 생성: 2.5 Pro
```

**장점:**
- 최고 품질 보장
- 일관성 유지

**단점:**
- 비용이 높음 (약 25배)

#### 옵션 3: 전체 2.0 Flash 전환
```
모든 생성: 2.0 Flash
```

**장점:**
- 비용 절감 (약 25배)

**단점:**
- 답변 품질 저하 가능 (경쟁사 비교, 리스크 분석 등)
- 구매 유도 효과 감소 가능
- 복잡한 포맷팅 규칙 준수 어려울 수 있음

---

## 최종 추천

### ⭐⭐⭐ 하이브리드 방식 (옵션 1)

**이유:**
1. **답변 생성의 중요성**: 
   - 구매 유도가 목표
   - 전문적 분석 필요
   - Google Grounding 활용
   - 복잡한 포맷팅 규칙
   → **2.5 Pro 필수**

2. **질문 생성의 단순성**:
   - 패턴 기반 생성
   - 복잡한 추론 불필요
   → **2.0 Flash 충분**

3. **대화형 스레드**:
   - 설계사 댓글: 2.5 Pro (일관성, 전문성)
   - 고객 댓글: 2.0 Flash (단순 질문)

**예상 비용 절감:**
- 질문 생성: 25배 절감
- 고객 댓글: 25배 절감
- 전체적으로 약 40-50% 비용 절감 가능

**구현 방법:**
```typescript
// 질문 생성
const questionModel = 'gemini-2.0-flash'

// 답변 생성
const answerModel = 'gemini-2.5-pro'

// 대화형 스레드
const threadModel = isCustomerTurn 
  ? 'gemini-2.0-flash'  // 고객 댓글
  : 'gemini-2.5-pro'    // 설계사 댓글
```

---

## 결론

**현재 프롬프트의 복잡도를 고려할 때:**

1. **질문 생성**: 2.0 Flash 적합 ✅
2. **답변 생성**: 2.5 Pro 필수 ✅✅✅
3. **대화형 스레드**: 하이브리드 권장 ✅

**최종 추천: 하이브리드 방식**
- 비용 효율성과 품질의 최적 균형
- 중요한 답변은 2.5 Pro로 품질 보장
- 단순한 질문은 2.0 Flash로 비용 절감
