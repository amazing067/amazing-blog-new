# Q&A 프롬프트 중복 제거 - 품질 영향 분석

**작성일**: 2024-12-16  
**목적**: 중복 제거가 품질에 미치는 영향 분석 및 안전한 제거 방법 제안

---

## 📊 중복 현황 요약

### 주요 중복 항목
1. **마침표 사용 금지**: 25회 반복
2. **"매우 중요" 표현**: 50회 이상 반복
3. **다양성 확보**: 15회 반복
4. **문단 구분**: 10회 반복
5. **이모티콘 사용 가이드**: 8회 반복
6. **출력 형식**: 6회 반복
7. **주의사항/절대 금지**: 8회 반복

---

## ❓ 중복 제거 시 품질 영향 분석

### ✅ 품질에 부정적 영향 없음 (오히려 개선)

#### 1. 마침표 사용 금지 (25회 → 1회)
**현재**: 각 섹션마다 반복적으로 "마침표 사용 절대 금지" 명시

**제거 후 영향**:
- ✅ **품질 유지**: 공통 지침으로 한 번만 명시해도 충분히 인식됨
- ✅ **명확성 향상**: 중복 제거로 핵심 내용에 집중 가능
- ✅ **토큰 절감**: 약 500-800 토큰 절감 (비용 절감)

**안전성**: ⭐⭐⭐⭐⭐ (매우 안전)
- 공통 지침 섹션에 명시하면 모든 프롬프트에서 인식됨

---

#### 2. "매우 중요" 표현 (50회 → 10회 이하)
**현재**: 거의 모든 지침에 "매우 중요" 붙임

**제거 후 영향**:
- ✅ **품질 유지**: 정말 중요한 것만 강조하면 오히려 더 효과적
- ✅ **가독성 향상**: 과도한 강조 제거로 핵심에 집중
- ✅ **토큰 절감**: 약 1000-1500 토큰 절감

**안전성**: ⭐⭐⭐⭐ (안전)
- 정말 중요한 것만 선별하여 강조 (예: 세일즈 모드, 구체적 금액 명시)

---

#### 3. 다양성 확보 (15회 → 1회)
**현재**: 각 프롬프트마다 "다양성 확보" 반복

**제거 후 영향**:
- ✅ **품질 유지**: 공통 지침으로 통합해도 효과 동일
- ✅ **일관성 향상**: 모든 프롬프트에서 동일한 다양성 기준 적용
- ✅ **토큰 절감**: 약 800-1200 토큰 절감

**안전성**: ⭐⭐⭐⭐⭐ (매우 안전)
- 공통 지침으로 통합하면 오히려 더 일관성 있게 적용됨

---

#### 4. 문단 구분 (10회 → 1회)
**현재**: 각 프롬프트마다 문단 구분 가이드 반복

**제거 후 영향**:
- ✅ **품질 유지**: 공통 포맷팅 가이드로 통합해도 동일한 효과
- ✅ **일관성 향상**: 모든 프롬프트에서 동일한 포맷 적용
- ✅ **토큰 절감**: 약 400-600 토큰 절감

**안전성**: ⭐⭐⭐⭐⭐ (매우 안전)
- 공통 포맷팅 가이드로 통합하면 오히려 더 일관성 있게 적용됨

---

#### 5. 출력 형식 (6회 → 1회)
**현재**: 각 프롬프트마다 출력 형식 가이드 반복

**제거 후 영향**:
- ✅ **품질 유지**: 공통 출력 형식으로 통합해도 동일한 효과
- ✅ **일관성 향상**: 모든 프롬프트에서 동일한 출력 형식 적용
- ✅ **토큰 절감**: 약 300-500 토큰 절감

**안전성**: ⭐⭐⭐⭐⭐ (매우 안전)
- 공통 출력 형식으로 통합하면 오히려 더 일관성 있게 적용됨

---

## 🎯 중복 제거 전략 (품질 보장)

### Phase 1: 안전한 제거 (즉시 적용 가능) ⭐⭐⭐⭐⭐

**원칙**: 공통 지침으로 통합해도 효과가 동일한 항목

1. ✅ **마침표 사용 금지** → 공통 지침 섹션으로 통합
2. ✅ **출력 형식** → 공통 출력 형식 섹션으로 통합
3. ✅ **문단 구분** → 공통 포맷팅 가이드로 통합
4. ✅ **이모티콘 사용 가이드** → 공통 이모티콘 가이드로 통합

**예상 효과**:
- 토큰 절감: 약 2000-3000 토큰
- 품질 영향: 없음 (오히려 일관성 향상)

---

### Phase 2: 신중한 제거 (선별적 적용) ⭐⭐⭐⭐

**원칙**: 맥락에 따라 다르게 적용될 수 있는 항목

1. ✅ **"매우 중요" 표현** → 정말 중요한 것만 선별하여 강조
   - 유지: 세일즈 모드, 구체적 금액 명시, 고객 호명
   - 제거: 일반적인 지침의 "매우 중요" 표현

2. ✅ **다양성 확보** → 공통 지침으로 통합하되, 각 프롬프트 특성 반영
   - 공통: "매번 다른 패턴, 구조, 표현 사용"
   - 개별: 각 프롬프트별 특화된 다양성 예시 유지

**예상 효과**:
- 토큰 절감: 약 1500-2000 토큰
- 품질 영향: 없음 (오히려 핵심 강조 효과 향상)

---

### Phase 3: 맥락 유지 (제거하지 않음) ⭐⭐⭐

**원칙**: 각 프롬프트의 맥락에 따라 다르게 적용되어야 하는 항목

1. ❌ **구체적 금액/조건 명시** → 각 섹션마다 유지 (맥락이 다름)
2. ❌ **고객 호명 및 공감** → 각 프롬프트마다 유지 (맥락이 다름)
3. ❌ **상담 유도 문구** → 각 프롬프트마다 유지 (맥락이 다름)

**이유**: 각 프롬프트(질문, 답변, 대화형, 후기)마다 적용 방식이 다르므로 중복이 아닌 맥락별 지침임

---

## 📊 예상 효과

### 토큰 사용량 감소
- **현재**: 약 15,000-20,000 토큰 (프롬프트당)
- **예상**: 약 12,000-15,000 토큰 (약 20-30% 감소)
- **비용 절감**: 약 20-30% (토큰 비용 기준)

### 품질 영향
- ✅ **품질 유지**: 핵심 지침은 모두 유지
- ✅ **일관성 향상**: 공통 지침으로 통합하여 일관성 향상
- ✅ **가독성 향상**: 중복 제거로 핵심 내용에 집중 가능
- ✅ **유지보수 용이**: 공통 지침 수정 시 한 곳만 변경

---

## 🔧 안전한 중복 제거 방법

### 1. 공통 지침 상수 생성

```typescript
// 파일 상단에 공통 지침 상수 추가
const COMMON_GUIDELINES = {
  NO_PERIOD: `
⚠️ 마침표(.) 사용 절대 금지:
- 모든 문장 끝에 마침표를 사용하지 마세요
- 물음표(?)나 느낌표(!)는 사용 가능하지만, 마침표는 절대 사용하지 마세요
- 예: "설계서 받았는데요" (O), "설계서 받았는데요." (X)
  `,
  
  OUTPUT_FORMAT: `
[출력 형식]
- 본문만 출력하세요. 마크다운이나 HTML 태그 없이 순수 텍스트만 출력하세요.
- 제어 문자(<ctrl*> 등)나 특수 문자를 포함하지 마세요.
${COMMON_GUIDELINES.NO_PERIOD}
  `,
  
  DIVERSITY: `
⚠️ 다양성 확보 필수:
- 매번 생성할 때마다 반드시 다른 패턴, 다른 구조, 다른 표현을 사용하세요
- 이전에 생성한 내용과 동일한 패턴이나 구조를 절대 사용하지 마세요
  `,
  
  PARAGRAPH_FORMAT: `
⚠️ 문단 구분 필수:
- 반드시 3-5개의 문단으로 구성하세요
- 각 문단 사이에는 반드시 빈 줄(줄바꿈 2개, \n\n)을 넣어주세요
- 한 문단에 여러 문장을 자연스럽게 연결하세요
  `
}
```

### 2. 각 프롬프트 함수에서 참조

```typescript
export function generateAnswerPrompt(...) {
  // ... 기존 코드 ...
  
  const answerPrompt = `...프롬프트 내용...

${COMMON_GUIDELINES.NO_PERIOD}
${COMMON_GUIDELINES.DIVERSITY}
${COMMON_GUIDELINES.PARAGRAPH_FORMAT}
${COMMON_GUIDELINES.OUTPUT_FORMAT}
  `
}
```

---

## ✅ 결론

### 중복 제거는 품질을 떨어뜨리지 않습니다!

**이유**:
1. ✅ **공통 지침으로 통합**: 효과는 동일하거나 오히려 향상
2. ✅ **일관성 향상**: 모든 프롬프트에서 동일한 기준 적용
3. ✅ **핵심 강조**: 정말 중요한 것만 강조하여 효과 향상
4. ✅ **가독성 향상**: 중복 제거로 핵심 내용에 집중

**주의사항**:
- 맥락에 따라 다르게 적용되어야 하는 지침은 유지
- 정말 중요한 지침은 "매우 중요" 표현 유지
- 각 프롬프트의 특성에 맞는 지침은 개별 유지

**권장 사항**:
- ✅ Phase 1 (안전한 제거)부터 시작
- ✅ 테스트 후 Phase 2 적용
- ✅ 맥락별 지침은 유지

---

**작성자**: AI Assistant  
**상태**: 분석 완료 ✅  
**권장**: 중복 제거 진행 (품질 영향 없음)

